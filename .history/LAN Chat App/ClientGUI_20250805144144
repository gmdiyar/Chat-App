import json
import random 

class User:
    def __init__(self, username, password):
        self.username = username
        self.password = password

        with open('users.json', 'r') as file:
            users = json.load(file)
            if self.username not in users:
                self.register()
    
    def userIDGenerator(self):
        newID = random.randint(1,10000)
        with open('users.json', 'r') as users:
            while newID in users:
                newID = random.randint(1,10000)

    def register(self, username, password):
        newUser = {'username': username,
                    'password': password, 
                    'userID': self.userIDGenerator()
                    }
        try:
            with open('users.json', 'r') as file:
                    users = json.load(file)
        except (FileNotFoundError, json.JSONDecodeError) :
            users = []

        users.append(newUser)

        with open('users.json', 'w') as file:
            json.dump(users, file, indent=4)

if __name__ == "__main__":
    User('diyargiyash', 'password123!')